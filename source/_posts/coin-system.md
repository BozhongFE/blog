---
title: 关于竞拍系统
date: 2018-08-23
tags:
 - javascript
---

基于 `thinkjs` 提供服务， 前端用 `vuejs`，后端用 `element-ui`
<!--more-->

## 背景

此处忽略10000个字。。。
没有独立的应用服务、没有前端界面、没有后台管理
> 有的只是算法逻辑，及其对应的脚本

这个算法逻辑就是把OA上的考勤转化成算力，多个纬度的算法来计算算力的，再者跑了很多次数据，最后调整完这个相对公平的算法，那是后没有独立服务，都是直接在oa系统下面写了脚本跑数据的

## 发展

独立成发币系统

> 于是放弃express，选了<a href="https://thinkjs.org/" target="_blank">thinkjs</a>搭建服务
> 前端选了vuejs
> 后端选了element-ui

## 竞拍

### 需要考虑的

+ `thinkjs` 处理接口服务，`nginx` 处理静态文件（最好cdn）
+ `应用程序` 和 `数据库服务` 需要分离
+ 缓存服务 `redis` 加速接口请求，分担数据库压力
+ 前端控制重复请求，控制高频率请求、逻辑判断
+ （集群）

## 坑

### 更新代码后session失效，无限跳登录

用了 `session` 做登录信息处理，用户数据少，所以用了 `session-file` 

> 由于file是写入本地
> hg更新文件后改了文件的所属用户组，导致file写入失败
> 最后登录成功，session写入失败，进行无限跳转登录

解决方法：改成使用数据服务，这里使用 `session-redis` 解决
