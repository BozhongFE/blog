---
title: 版本号规范
date: 2019-10-25
tags:
 - version
---

## 问题由来？

+ 项目版本号怎么定义？
+ 组件库、插件库版本号怎么定义？
+ 小程序版本号怎么定义？
<!--more-->

## 软件版本阶段说明

## 软件版本号

由四部分组成，包含五种版本号类型

### 主版本号.子版本号.阶段版本号（.日期版本号_希腊版本号）

```version
1.1.1.191025_beta
```

### 希腊版本号

#### Base版（静态页）
此版本表示该软件仅仅是一个假页面链接，通常包括所有的功能和页面布局，但是页面中的功能都没有做完整的实现，只是做为整体网站的一个基础架构。

#### Alpha版（本地开发）
此版本表示该软件在此阶段主要是以实现软件功能为主，通常只在软件开发者内部交流，一般而言，该版本软件的Bug较多，需要继续修改。

#### Beta版（office）
该版本相对于α版已有了很大的改进，消除了严重的错误，但还是存在着一些缺陷，需要经过多次测试来进一步消除，此版本主要的修改对像是软件的UI。

#### RC版（online）
该版本已经相当成熟了，基本上不存在导致错误的BUG，与即将发行的正式版相差无几。

#### Release版（product）
该版本意味“最终版本”，在前面版本的一系列测试版之后，终归会有一个正式版本，是最终交付用户使用的一个版本。该版本有时也称为标准版。一般情况下，Release不会以单词形式出现在软件封面上，取而代之的是符号(Ｒ)。


### 版本号修改规则

#### 主版本号（1）
当功能模块有较大的变动，比如增加多个模块或者整体架构发生变化。此版本号由项目决定是否修改。

#### 子版本号（1）
当功能有一定的增加或变化，比如增加了对权限控制、增加自定义视图等功能。此版本号由项目决定是否修改。

#### 阶段版本号（1）
一般是 Bug 修复或是一些小的变动，要经常发布修订版，时间间隔不限，修复一个严重的bug即可发布一个修订版。此版本号由项目经理决定是否修改。

#### 日期版本号（191025）
用于记录修改项目的当前日期，每天对项目的修改都需要更改日期版本号。此版本号由开发人员决定是否修改。

#### 希腊字母版本号（beta）
此版本号用于标注当前版本的软件处于哪个开发阶段，当软件进入到另一个阶段时需要修改此版本号。此版本号由项目决定是否修改。

#### Tips
- 主版本号、子版本号、阶段版本号是必须的
- 日期版本号、希腊字母版本号是可选

## 例子

我们先看下例子感受下版本号

### 微信
|版本|版本内容|
|---|---|
|6.6.7| 可以把浏览的文章缩小为浮窗
|6.7.0| 可以直接浏览订阅号的消息
|6.7.1| 可以把常用的小程序添加到“我的小程序”
|6.7.2| 可以使用英语和粤语进行语音输入了
|6.7.3| 可以拍一个自己的表情, 聊天输入文字时可以长按换行
|6.7.4| 兼容 iPhone XS, iPhone XS Max，在表情面板，可以拍自己的表情
|7.0.0| 时刻视频、冒个泡、好看、强提醒等

### bz-app-plugins
|版本|版本内容|
|---|---|
|1.0.0| vue插件-toast/loading/alert/confirm
|2.0.0| rem初始化代码由外部控制传参执行
|3.0.0| 新增外部选择性安装插件/样式风格选择/去掉require引用时的default层/npm安装
|3.0.1| 修正ExtractTextPlugin配置错误
|3.0.2| 低版本安卓机es6兼容问题，降低webpack-dev-server版本
|3.0.2| toast可不自动隐藏，弹窗类传空字符串不显示相应的标题/文本
|4.0.0| 更新webpack配置，去除rem相关内容，内部样式尺寸单位改em模块/样式/组件拆分外部可按需引入。
|4.1.0| 新增ivf样式，alert/confirm新增弹窗顶图传入
|next| alert/confirm 修正 title 取值错误问题

## 语义化版本

主版本号.次版本号.修订号（-先行版本号）（+版本编译元数据）

- 常规版本号  
`1.0.0`

- 先行版本号 - 标签（npm）  
`1.0.0-demo.3`  
`1.0.0-beta.10`  
`1.0.0-stable`  

- 先行版本号 - 希腊字母  
~~`1.0.0-base.10`~~  
~~`1.0.0-alpha.2`~~

- 版本编译元数据  
~~`1.0.0+20130313144700`~~  
~~`1.0.0+exp.sha.5114f85`~~  
~~`1.0.0-beta.1+20130313144700`~~  
~~`1.0.0-beta.1+exp.sha.5114f85`~~  

### npm 版本管理

- 主版本号（`major`）：软件做了不兼容的变更（breaking change 重大变更）
- 次版本号（`minor`）：添加功能或者废弃功能，向下兼容
- 补丁版本号（`patch`）：bug 修复，向下兼容

#### 标签

|标签|意义|补充|
|---|---|---|
|demo|demo版本|可能用于验证问题的版本
|dev|开发版|开发阶段用的，bug 多，体积较大等特点，功能不完善
|alpha|α版本|用于内部交流或者测试人员测试，bug较多
|beta|测试版(β版本)|较α版本，有较大的改进，但是还是有bug
|gamma|（γ）伽马版本|较α和β版本有很大的改进，与稳定版相差无几，用户可使用
|trial|试用版本|本软件通常都有时间限制，过期之后用户如果希望继续使用，一般得交纳一定的费用进行注册或购买。有些试用版软件还在功能上做了一定的限制。
|stable|稳定版|&nbsp;
|csp|内容安全版本|js库常用
|latest|最新版本|不指定版本和标签，npm 默认安最新版

## 实际应用

### 组件插件

内部组件一般托管于 `github`、`npm`，所以需要使用 `NPM 版本管理规范`

### 小程序

前端一般对版本号感知不明显，尤其是平常项目基本用不到版本号。  
但是自从小程序出现之后，小程序版本号雷同 APP 版本号，所以我们需要对小程序版本号进行管理。

### 微信小程序版本管理

小程序自身分为 `线上版本`、`审核版本`、`开发版本`、`体验版`

#### 线上版本

- 用户实际使用的版本

#### 审核版本

- 审核中的版本
- 从`开发版本`中，选择一个 `提交审核`

#### 开发版本
- 开发者上传的版本
- `开发者` 从 `微信开发者工具` 打包上传后的版本

#### 体验版
- 顾名思义，即体验的版本
- 从`开发版本`中，选中一个设为`体验版`（只能存在一个）

### 版本号规则

综上所述，只有体验版可用于测试，但是区分不了环境（`dev`、`office`、`online`、`product`），所以我们需要自定义版本号规则。

主版本号.次版本号.阶段版本号（-环境版本号.打包版本号）

#### 环境版本号

`dev` `office` `online` `product`

#### 打包版本号

`打包次数`, 从 `0` 开始

#### 场景使用
```bash
# 开发版本
1.2.1-dev.x

# 测试 office
1.2.1-office.x

# 测试 online
1.2.1-online.x

# 测试 product
1.2.1-product.x

# 提交审核
1.2.1
```

#### 话外
另外小程序其他规则请前往小程序版本库查看 `readme.md`

### 需求项目

按照小程序版本号来

## 语义化版本升级规则

```
默认情况下，当用--save或者--save-dev安装一个模块时，npm通过脱字符(^)来限定所安装模块的主版本号，而该脱字符对于不同的版本号有不同的更新机制

^1.2.1 代表的更新版本范围为 >=1.2.1 && < 2.0.0
^0.2.1 代表的更新版本范围为 >=0.2.1 && < 0.3.0
^0.0.2 代表的更新版本范围为 0.0.2（相当于锁定为了0.0.2版本）
```

## 参考链接

https://semver.org/lang/zh-CN/ (必看)
https://www.cnblogs.com/fan-yuan/p/8425699.html
https://segmentfault.com/a/1190000018714929

<style>
table {
  width: auto;
}
tr td:nth-child(1) {
  min-width: 50px;
}
tr td:nth-child(2) {
  min-width: 100px;
}
</style>